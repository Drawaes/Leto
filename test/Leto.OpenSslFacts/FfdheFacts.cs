using System;
using System.Buffers;
using System.Collections.Generic;
using System.IO.Pipelines;
using System.Text;
using System.Threading.Tasks;
using Leto.KeyExchanges;
using Leto.OpenSsl11.Internal;
using Xunit;

namespace Leto.OpenSslFacts
{
    public class FfdheFacts
    {
        //[Fact]
        public void TouchStatic()
        {
            //Simple ensure that the static load works
            Assert.Equal(256, FfdheRfc7919.P2048.Length);
            Assert.Equal(256, FfdheRfc7919.Q2048.Length);
            Assert.Equal(384, FfdheRfc7919.P3072.Length);
            Assert.Equal(384, FfdheRfc7919.Q3072.Length);
            Assert.Equal(512, FfdheRfc7919.P4096.Length);
            Assert.Equal(512, FfdheRfc7919.Q4096.Length);
            Assert.Equal(768, FfdheRfc7919.P6144.Length);
            Assert.Equal(768, FfdheRfc7919.Q6144.Length);
            Assert.Equal(1024, FfdheRfc7919.P8192.Length);
            Assert.Equal(1024, FfdheRfc7919.Q8192.Length);
        }

        //[Fact]
        public async Task Ffde4096KnownDerivedValue()
        {
            var privKeyHex = "73-DD-53-6D-26-6F-F5-33-5B-11-E1-91-F5-D0-C8-12-B9-94-4C-92-25-90-D2-22-66-75-6A-34-E4-32-E8-07-0C-A4-9A-BA-73-14-8E-B6-57-CC-54-D0-F9-DA-83-65-FF-F6-99-CF-CB-32-6E-E6-5D-85-32-B6-33-88-E9-56-7D-EC-37-37-92-57-00-0D-68-55-CF-F0-67-A3-EF-CB-16-CB-7A-EA-12-51-7A-FE-AD-D7-5B-16-59-2E-B5-69-CD-8A-D2-CC-07-6E-0B-DF-B4-85-04-B5-D4-2D-90-B4-28-F7-A5-AF-86-C7-14-6E-64-9F-1C-C5-18-74-BE-B8-50-06-56-0A-B9-5E-21-5B-41-1E-2F-C2-AA-E1-71-83-FE-5A-E6-43-A2-2D-9E-94-17-47-0C-50-BA-23-17-41-46-C9-C5-18-E1-8B-FC-F1-51-CD-9D-19-4A-64-9A-EC-EC-D1-77-AE-59-99-20-7D-85-E4-83-96-40-08-C5-A1-1B-8E-9E-27-4F-F3-F3-50-4B-ED-3E-83-2B-7F-2A-6A-BB-63-58-FE-DA-65-EE-C2-6D-A8-35-AE-8D-AE-82-8B-91-B6-25-48-F2-88-87-D5-6D-BA-7A-4A-CC-0E-56-D7-EA-AB-00-C0-D7-C9-14-23-5B-1D-DF-60-8C-26-F3-D3-9F-FB-D9-A3-9D-D4-4A-1F-1A-96-B7-AF-51-C0-8C-62-86-AE-89-4D-FC-12-16-F0-EC-FF-09-9D-AC-2D-B5-12-1C-1A-58-8A-A5-D3-8F-B4-CA-3D-03-42-04-32-C8-CD-9B-88-7E-62-25-5E-1A-97-BD-50-6E-C4-D5-A8-C0-DF-9B-95-79-B5-45-B0-3F-A9-E2-D3-57-53-11-AA-BB-E0-C7-48-ED-95-B3-52-03-79-7B-F7-F1-C4-BA-A0-96-85-EE-E7-1A-55-7F-6A-DB-4F-B9-3A-95-5E-04-1A-B3-30-56-03-36-9D-23-C4-EA-AE-AB-01-28-01-C3-0E-6B-2B-E2-17-3A-99-58-BA-76-CB-71-D4-DA-3C-35-E5-AB-7E-E6-F8-5A-CB-A8-F6-E3-28-46-C6-2B-93-71-EA-9D-80-74-0B-A7-CC-E3-58-FF-D0-1B-8C-BC-90-AF-E1-7E-05-FE-CC-F0-F5-FA-AB-E1-24-7A-93-EC-12-87-50-41-DC-83-C1-74-38-24-ED-57-C6-26-B4-B1-8E-D8-64-85-C4-CA-C2-D3-EC-B0-AE-11-DB-5E-63-15-A5-62-45-F9-47-C8-A5-0C-FD-BC-E6-81-F8-9B-51-F8-A2-F9-BD-FE-53-EA-28-54-B7-38-79-27-81-B4-C8-A2-72-91-B9-0B-1B";
            var peerKeyHex = "C9-3B-8A-0F-75-30-77-B8-77-24-8E-8B-DB-9C-A8-FC-F3-74-A2-B7-B0-A0-AE-7B-92-A0-D5-E9-DA-B4-01-6E-FE-CD-4A-44-C5-31-AA-F6-AE-DF-12-30-E3-39-1F-05-2A-A1-E9-0F-2B-DE-BD-B0-A0-12-3D-E1-E4-E9-67-22-14-5B-BF-8C-23-3A-3E-55-70-48-CC-46-F1-85-74-2A-4B-AB-90-AA-65-BC-1D-BD-16-86-0B-FB-69-7E-00-FE-93-77-80-78-93-96-AA-6D-8D-A0-57-96-AC-BD-14-64-FC-53-CA-32-EC-79-49-D5-BF-FA-D4-A8-C6-5D-1A-5A-28-84-A3-9A-CA-9A-50-CC-A4-3B-EA-FF-B4-5D-2F-B9-B7-E0-7B-62-66-4E-9F-2A-7A-91-CC-25-99-7F-C2-75-0B-62-83-EA-7D-10-D7-22-3B-37-C8-A3-12-EC-C0-3F-76-44-79-4F-A9-2B-FE-64-9A-CC-58-30-AB-16-60-CD-40-8A-6F-7F-52-38-7E-33-5E-65-A6-94-08-67-46-B6-00-75-67-71-ED-79-BD-35-CB-7F-90-7E-21-83-C8-59-EF-5D-78-C7-4C-7A-B5-55-DC-7B-B6-5C-BA-BA-94-23-D4-4E-D6-CE-9B-7F-F0-65-05-7F-77-FA-79-3A-BE-8A-C0-F4-21-C5-10-87-19-18-C6-EE-01-56-B0-E1-64-20-80-93-F9-81-FA-6C-0C-E1-E5-E9-1B-98-95-19-14-DE-A0-59-CE-51-BD-8D-90-58-D2-3B-2D-6F-64-E3-1A-07-CF-55-47-F8-9E-CA-93-6C-AC-A6-2F-77-CF-DE-11-87-5B-14-3C-D6-72-30-DE-92-4A-C7-D1-02-D3-8D-3C-B2-88-89-0D-A2-A9-A0-FE-91-8B-C0-C9-31-D3-CC-99-A4-BC-16-E4-85-CC-FF-54-70-8A-25-19-CB-BC-C6-1C-CD-B2-75-96-95-72-D2-C8-C2-DD-DE-E7-DD-AF-A6-8B-87-59-73-7C-33-4A-9E-D9-82-8D-5B-D4-70-40-FE-42-96-89-59-9A-46-B9-47-89-4B-5E-EE-08-E0-A9-2A-A4-8B-45-66-B9-24-70-A4-B4-61-86-CA-65-1F-DB-7A-D5-23-7A-EF-91-D2-61-21-4F-43-70-ED-C4-05-D8-F1-A8-CA-9E-42-50-0F-48-99-4A-26-BC-0E-23-6C-6A-D2-86-E9-A6-B9-2C-B8-90-9A-14-F4-78-D7-32-5A-DF-D6-9C-27-36-14-76-25-03-FB-2E-A2-2C-04-D6-E5-86-83-67-12-8F-CD-7D-AD-30-27-DB-F3-0C-FF-0E-8B-4A-2F-EF-DB";
            var secretHex = "4C-2C-F2-F9-A6-88-37-C9-83-77-62-89-D5-E0-34-55-26-03-1F-EE-6F-97-F4-ED-A4-83-32-7A-E5-24-1C-CA-2D-A6-1C-E5-E8-92-4C-B5-1F-F8-53-0B-9A-95-7F-92-FA-B8-65-E7-03-82-FF-60-41-39-52-BB-F3-85-36-00-27-A2-1C-B6-B2-CF-5B-C8-1C-D0-30-02-C4-E6-48-2B-F3-C3-8C-DA-D7-D8-B6-1D-DD-D3-71-CB-7B-0F-A8-90-4C-DA-37-39-29-87-AB-9B-30-E7-EB-DD-C5-D4-C4-E0-ED-5D-B7-A4-A4-1D-C6-B1-8F-A5-D9-16-20-F6-5F-EE-64-FC-AB-96-D2-14-6C-96-32-4D-B1-C6-DA-7F-40-4A-D5-2D-3C-89-67-86-EE-69-B5-AB-1F-A7-DC-21-58-5B-DB-C5-E8-67-7F-4D-D3-01-50-46-61-AE-E7-69-CB-87-93-05-87-C8-E7-31-52-52-64-A6-D3-39-91-D9-84-69-95-AE-E1-38-6D-CA-B4-41-20-AC-BE-FD-D0-AE-D0-24-51-13-F4-CB-17-F5-8D-09-E2-D3-B3-ED-1A-2C-21-D4-17-1A-D1-D0-F9-71-E7-8F-28-7F-0B-F0-01-D3-11-2C-10-D9-1C-2F-6C-76-D0-A8-9C-20-AE-2E-82-6B-9E-E4-98-84-43-5F-26-D9-93-22-9E-25-38-35-61-C5-66-D3-16-02-49-17-EE-05-B0-71-89-BC-41-D3-54-8E-54-13-23-90-DA-62-BA-19-48-47-F1-3F-65-25-D9-F0-6F-D5-A8-4D-7D-9D-6B-E7-0A-4F-D6-DF-50-D1-1D-69-F3-5A-61-C9-EF-BE-79-8D-32-A2-17-C7-2E-19-18-08-5E-EE-E5-7A-F4-31-0E-44-67-A5-85-F9-A6-3A-92-DF-4F-EE-73-A4-F1-BB-4B-4A-42-AD-20-2C-3A-0E-D5-55-DD-5B-C3-35-C5-01-CE-1A-71-FA-8C-13-A3-E3-B0-C5-DF-E0-1B-E3-43-BF-C3-86-E8-B1-1D-9C-6A-1A-68-8A-1D-3F-37-3A-45-9C-0D-58-FF-3E-7C-2B-EE-D9-81-66-82-BE-8D-21-1A-6B-40-58-C6-E9-28-6D-8E-4C-BF-8B-64-B9-B9-C4-4F-4C-18-68-96-C6-4F-5B-77-B5-2A-E8-18-F4-41-C0-49-70-9C-7B-E3-2E-D1-39-30-CF-FA-41-79-23-17-60-26-B6-76-D5-1B-8D-00-F2-BB-AC-9E-44-E4-E1-1B-72-04-72-3B-7C-69-A5-69-E3-32-CC-E3-FD-DE-96-6C-3A-BC-A5-F3-7C-65-AC-8A-61-1F-32-39-F3-0F-B6";
            var publicKeyHex = "34-06-33-12-E0-71-56-AD-17-43-39-1C-82-86-23-2F-0F-F3-BE-22-05-D8-E7-BC-BC-0F-E3-4D-60-75-E3-AF-28-80-45-0C-F8-89-F5-A3-B5-BB-E5-1F-FE-38-6A-84-6E-98-FE-0A-F6-FF-06-2A-B2-BC-51-F9-A3-0F-8E-29-76-F1-D1-C3-E4-E7-29-74-6D-6E-1B-6A-E1-F0-F2-08-25-17-E0-F6-AE-29-5A-BC-32-33-C1-F3-7F-28-6C-60-A3-9D-2D-61-C0-74-44-44-72-38-DF-C8-93-7F-3B-16-ED-E4-E0-C4-C6-38-43-CA-8C-83-4E-5E-11-85-7A-CB-76-0D-C5-5B-44-50-56-04-A5-9B-3A-81-8E-D0-7F-99-16-3C-2A-CC-84-1B-98-FC-6A-AF-80-AE-6F-54-8C-FF-3E-01-DD-BA-9F-D8-7F-67-F5-6F-5A-46-01-56-B3-BA-EF-FE-32-70-C4-93-6F-09-46-A4-BF-94-AC-D0-F5-ED-77-89-47-CD-16-C3-47-A5-87-37-40-EF-23-B0-F9-F7-62-74-CC-3B-58-6E-D5-20-E8-B6-2C-D5-6D-93-9B-13-31-51-35-5F-7C-9D-D1-24-73-8C-C0-40-98-92-B5-D2-61-FC-5D-3F-AF-96-CA-0D-CF-88-D9-72-CB-50-19-B2-FE-14-C2-21-48-97-95-08-C6-03-44-42-FB-3D-BC-41-36-CA-F5-A0-2A-85-1B-D2-B3-C3-CE-E7-81-85-F4-BE-9C-28-EC-AD-D2-D4-26-78-3A-D7-33-5B-28-27-B3-0D-E5-AA-49-2F-72-2F-27-5D-02-D8-28-CC-D7-38-95-DF-03-DF-24-33-0D-71-3D-44-72-0E-0C-47-6F-00-5F-F8-82-6C-B8-C1-5F-F7-B5-A7-98-99-98-3B-2C-C7-76-4B-B3-48-08-83-F2-10-D1-4C-22-A7-7B-E9-D4-50-3D-7E-C3-7F-1F-1E-EE-F5-3C-F7-08-74-51-73-89-2A-3C-C5-A5-AE-45-32-F6-B9-AD-1D-6A-B2-BB-36-46-DB-A8-B3-2C-AC-DB-78-69-F9-02-08-8D-CF-EF-1E-8D-62-19-48-6B-4A-A1-06-AF-8C-53-99-D3-15-CA-67-57-71-D4-28-4A-87-7E-8B-2F-13-3B-B7-9B-85-19-EB-99-52-23-92-21-09-87-7F-22-C6-C9-F3-61-9E-81-BF-7B-F2-81-54-3C-F4-66-40-48-18-CF-1C-58-2B-22-B1-E0-8D-60-22-89-83-E4-CC-2A-61-BF-48-8B-CC-E2-C3-ED-58-F2-92-5A-74-DE-AB-33-55-68-31-5B-84-04-61-6E-59-53-F3";
            var privKey = HexFunctions.ToBytes(privKeyHex);
            var peerKey = HexFunctions.ToBytes(peerKeyHex);
            var publicKey = HexFunctions.ToBytes(publicKeyHex);
            var secret = HexFunctions.ToBytes(secretHex);
            await CheckSecret(NamedGroup.ffdhe4096, privKey, peerKey, publicKey, secret);
        }

        //[Fact]
        public async Task Ffde6144KnownDerivedValue()
        {
            var privKeyHex = "18-DE-77-C8-B2-80-9D-77-F2-86-A1-C6-16-C5-6B-4A-90-24-D7-5B-53-8E-56-6D-F0-71-2A-70-86-E6-8C-DC-21-45-2A-7C-AB-D1-0E-81-9B-35-91-68-64-26-DB-14-1D-19-88-4D-E1-B3-AF-1E-CC-0E-01-74-6A-A9-4D-48-42-8B-4F-FE-9F-31-6C-6D-AD-C0-9D-51-9B-65-16-CB-3C-92-43-45-98-72-38-59-79-C2-76-93-3A-25-46-F7-98-93-3B-3C-F4-6C-67-4E-93-EE-A6-A6-FE-2A-FC-CA-41-E8-54-BD-48-29-F1-09-37-85-70-F0-0B-E2-0E-B7-59-17-D5-73-32-9E-ED-83-69-2A-D6-DD-DD-9C-59-3C-9A-DA-72-2C-D9-B5-2D-32-97-D2-DE-56-24-B4-92-3F-A0-27-B9-5B-AB-6D-75-49-B4-08-C5-D4-7A-7C-49-34-52-43-27-F3-A5-3E-4B-35-E9-D1-5D-F1-25-FD-3D-6D-24-8A-39-00-8F-19-CD-E4-F9-4F-1B-CD-38-18-FA-1C-6C-B4-D0-35-22-91-65-41-DF-75-E2-99-8A-C1-CF-E1-13-E0-F9-AA-98-5C-FE-AA-60-C8-9E-7C-A0-94-D5-75-C4-79-3D-99-33-B8-3A-B3-C7-A0-76-54-7C-FD-D8-78-54-86-12-34-30-13-88-12-64-F6-14-E0-06-FD-99-22-58-AF-95-7E-D4-99-20-42-46-14-54-CE-00-2F-EC-8D-34-E3-54-88-2D-B1-9B-2E-8E-A3-99-1C-7C-18-F2-00-F2-23-1D-13-C9-92-C5-E2-5D-87-98-88-0E-6F-E2-6D-90-FB-75-96-01-73-80-58-AC-31-DB-06-1E-1A-C8-B4-DF-18-22-EB-84-B1-64-25-05-8E-16-09-17-0A-77-B6-FE-3C-A7-BA-E4-A4-BF-4F-E1-BE-EA-0D-BA-53-09-E0-51-94-8C-CB-DA-75-5C-0C-83-DC-C1-34-10-BA-DA-CC-96-16-56-8E-1E-E8-A1-77-D5-2D-0F-1C-46-A3-8D-29-5D-BF-22-DC-AB-6E-82-A9-E7-00-A2-9E-D2-E6-7A-99-0C-C8-02-26-64-6C-DD-3F-7A-40-88-BD-80-8F-D7-24-29-D8-D1-BF-B3-5E-84-23-0C-6A-47-42-02-CC-7B-D4-93-4F-82-CF-8C-00-02-D7-E8-B8-2D-93-59-0A-BB-6B-C8-DA-C7-94-B6-EF-9B-F2-85-15-39-77-6E-5E-21-CB-28-74-E2-74-F6-C3-9C-A3-9F-DD-B2-6F-56-0C-3B-D2-E1-DB-69-9A-D1-73-BE-48-B6-AA-DC-09-DB-7F-04-19-12-A3-3D-BE-2E-18-B7-53-CE-36-E8-92-6D-3E-39-62-2D-FD-B9-31-1F-35-81-DF-5F-BB-21-4D-68-2E-4C-EA-C0-F3-DB-4F-09-8B-E0-7E-96-E3-29-17-1A-20-2F-23-14-2D-10-90-4B-8F-F8-9E-95-25-F8-F8-09-90-C8-3F-9E-09-E3-48-46-57-4C-9D-4C-71-08-0B-CB-56-D7-7A-C2-13-83-36-E5-EC-59-02-F3-BD-D5-81-30-19-0F-0D-14-D7-CB-8F-4D-16-F5-86-8B-A9-8D-00-E1-98-AD-77-07-22-87-CA-98-08-EC-10-3F-B2-AB-99-CF-05-CC-54-7B-98-28-04-CE-18-FD-D6-4A-0F-71-A4-DC-15-7A-D7-61-F3-9A-08-62-99-F6-5C-C2-91-11-31-70-64-4B-89-E9-58-F4-55-55-F4-86-C3-B1-59-7C-52-A3-CE-69-5E-50-32-90-11-73-38-CF-C9-3F-FE-28-9D-D2-19-8B-49-50-74-16-DD-84-CA-8F-6A-B8-6A-80-BD-7E-C3-DA-12-47-C8-D3-65-78-67-6C-81-27-69-5E-EA-95-96-F1-FB-31-D3-8B-A8-4C-3E-4E-70-09-92-71-28-82-F2-2D-1E-80-82-88-29-B3-A3-EC-58-26-11-D7-27-07-E2-9E-C4";
            var peerKeyHex = "7C-B0-F5-39-18-07-CE-6F-A8-8A-2B-23-52-48-DA-18-A7-D9-38-3F-A9-75-E4-38-25-48-CB-9A-46-9A-58-3A-5D-25-A5-0A-FA-C0-8B-BC-BD-60-E5-F7-65-33-19-B5-B2-32-6A-FD-4C-4D-EA-CE-DE-F1-5F-BF-8F-91-4A-EA-7D-E3-1C-8D-88-50-08-5B-F9-51-E3-87-CB-3C-FB-62-BC-D4-00-20-78-89-84-B2-C6-4E-23-DB-71-BD-CF-6A-A9-CF-C5-A1-07-BC-D3-66-67-89-C6-C7-6B-E0-46-0B-94-BE-55-94-14-8C-B6-61-11-DF-72-22-E5-5D-A5-16-06-64-C6-5B-05-24-B4-8B-8D-07-85-92-A0-B9-6D-A6-93-28-1C-02-40-E3-A8-25-C3-6A-1E-27-62-70-5C-28-A3-F3-1D-82-4C-03-0A-B6-58-AB-6A-B9-81-9D-0A-CC-AD-35-03-05-E1-35-4D-16-19-95-4E-71-9A-8B-26-BF-C4-8F-33-FC-B5-D3-57-19-DE-E3-8C-21-4F-05-61-F8-F6-8D-92-D1-FB-63-CD-30-0A-FD-CD-D4-32-BD-7D-B8-C1-EF-30-8F-3C-CC-5F-29-7A-B5-7B-4D-7E-6B-32-F3-9E-36-30-10-B1-35-F7-F9-82-49-9C-1C-4B-D0-DE-81-DB-A8-0B-16-D7-C2-C2-2F-93-4D-CC-C8-65-2F-DC-71-3C-5C-A7-80-6C-6B-47-52-11-6C-3D-7F-09-73-0F-17-FE-36-31-CC-D6-49-49-B0-09-CD-9E-8A-67-CB-63-10-5D-5F-D7-C0-75-3D-B6-D7-15-39-36-2F-90-10-93-89-26-DF-72-E5-71-91-B8-51-F9-85-CB-01-C3-44-27-4F-5B-27-DA-CC-E4-37-49-54-80-5D-76-37-79-21-A8-46-DD-B0-18-E7-E0-E6-57-B4-8A-8F-AB-EF-50-20-7D-69-81-F1-5A-C3-F4-5A-17-E9-F8-EC-4A-CE-B6-79-10-12-60-76-6D-0E-00-CB-3E-69-E0-37-EA-91-E9-14-45-E5-40-57-F1-3B-4B-5B-CD-55-A9-09-FF-37-D1-DA-EB-E3-19-30-B5-C4-28-77-2F-4D-D3-86-64-B6-BC-1E-92-7A-65-34-FD-2D-AF-A0-68-B8-43-0F-C1-64-B0-DC-35-A2-FC-BC-35-0A-11-CE-B6-01-B5-74-8E-5D-B4-8A-5F-E8-96-F5-47-4A-52-10-DA-17-23-1E-0F-1D-18-E8-6E-A9-AB-7F-37-2D-8B-6E-0F-78-E0-D7-3E-A2-1F-E5-FE-35-F2-E6-64-B7-2F-A4-EE-2E-DE-F3-17-8E-3A-5E-F4-51-46-4C-B9-BC-17-08-1D-1E-7D-D4-2C-AD-FD-9D-F4-C1-B0-20-78-B6-14-03-F7-07-57-DE-76-8C-C1-F4-C5-2F-3E-8D-38-17-3A-56-E9-8F-22-87-AA-4C-41-CC-F4-2B-00-6F-41-3A-8C-59-DE-00-C5-58-AB-00-09-BB-05-CA-37-D7-15-10-7D-A8-C7-F0-CB-A0-F4-FE-83-E8-77-EC-87-6A-70-72-0F-F5-25-32-4F-22-FD-3E-42-8F-31-1F-CF-CF-BF-8F-86-C1-1F-E4-53-89-EE-E6-37-87-D3-FD-FB-39-37-B1-E5-DD-B3-1B-1A-E3-45-BA-34-5A-98-0A-17-D1-EE-63-D9-09-D2-F5-08-A2-07-A1-AB-B0-A2-C4-65-43-EA-94-12-6E-5F-BC-DB-BC-CC-31-CB-BF-C2-B1-15-97-AE-62-27-70-B3-A6-63-FC-0A-DE-24-3A-43-6B-BF-56-F8-C4-97-C4-D1-33-97-83-2B-6D-08-D5-9C-72-1D-9B-0C-8A-79-65-0F-9D-31-77-76-3B-37-93-09-9B-A2-50-BA-F3-AE-F5-B7-8E-A5-71-71-A3-4D-74-48-9D-9D-0C-70-1D-A5-24-71-DB-38-41-B9-B9-0E-38-DA-D2-46-9A-F0-DC-CD-10-B0-66-5E-1B-40-3F-EF-1C-45-54";
            var secretHex = "D5-F0-99-51-54-5B-89-A8-A7-08-5A-DC-6D-BC-DF-F1-88-71-4F-0F-82-93-6E-39-1B-FC-63-31-58-D5-BB-47-A6-9C-2E-BA-AA-B0-14-57-03-3A-83-90-6B-0A-CF-B6-63-71-AD-D0-58-CE-E5-8C-CD-3B-E2-78-3A-52-B6-34-00-F6-7E-9D-29-B8-DA-B4-14-5D-E6-60-AC-64-80-64-76-92-CE-92-BA-03-91-54-3F-A1-13-B0-CF-DF-D1-49-5B-9F-6D-B8-78-9F-ED-4F-04-16-68-74-99-8E-45-0A-89-51-FD-25-3D-73-A6-64-AA-FA-11-C3-27-A6-9E-DD-68-C9-E2-18-C7-E0-B4-2A-98-A1-5E-53-3A-52-84-31-CF-FF-02-27-0A-CD-71-39-32-86-6B-47-DF-D4-38-B1-61-6E-12-15-FF-0C-5B-D1-04-AC-7A-64-BF-9D-04-9E-2B-9A-61-62-31-28-E4-BF-CF-A2-37-5D-3E-41-66-12-E0-99-B8-A2-D7-BA-2F-56-73-9B-DE-8C-BE-5B-F8-12-8D-4C-98-03-4B-84-37-24-4E-36-6F-9E-2D-8D-4D-16-26-22-6B-10-DB-52-5D-BC-19-C8-F8-FD-EB-9C-1B-FA-37-BF-75-44-C7-A5-CB-6E-D1-AA-D1-71-AF-75-7E-65-8C-A1-5C-C8-3F-C1-E5-CD-F1-7E-F1-3E-CB-CB-42-E7-B3-30-8B-EC-0A-DF-0F-9B-1D-7D-AC-6E-FE-23-A2-B3-A0-96-A7-18-37-8F-4C-22-B7-C9-4D-16-FD-19-D1-B0-0E-F7-B9-2F-DA-1E-E5-0E-6A-55-DB-9E-FF-B8-A8-38-47-98-FB-6F-DF-E1-F3-00-01-06-A9-05-E0-70-45-0B-2C-B7-D7-E2-5B-3B-5E-AD-08-B3-28-52-58-9B-81-C5-F7-11-1D-E8-BE-AD-52-97-11-C8-E5-07-06-25-58-FB-CA-01-1C-E6-C5-5C-41-F9-38-FD-92-0E-1B-F3-C1-00-CB-3D-3D-A3-C1-09-7E-70-5C-34-D8-89-0B-35-16-85-1B-17-CE-67-16-01-A4-55-49-03-5F-04-56-08-3C-9E-E8-0A-F3-D6-A5-2F-19-0A-E7-5D-CD-1F-6A-A6-7E-F3-59-2F-9E-2B-3C-8F-9F-ED-9F-5E-2D-85-07-3F-83-C2-5A-8D-93-10-4A-A6-A6-5D-63-C4-81-4F-FB-18-E1-82-52-2C-99-B7-37-21-1B-C4-E5-23-C7-61-2D-FF-C1-84-85-12-61-FD-FB-0D-5B-89-B4-B6-CF-B3-2C-08-53-27-BD-07-BB-78-9F-3C-BA-FB-D8-EB-54-D6-86-D6-6C-E9-2A-AB-35-57-4C-A0-77-F8-24-AD-D7-F5-1D-AA-5E-23-16-58-6B-57-4D-32-D6-9F-64-F9-94-A2-85-62-D9-65-15-33-42-E3-98-AC-A1-2B-ED-CF-25-37-70-93-DB-FA-4D-C0-E8-BE-8A-D5-37-EB-C0-90-57-0E-DF-0D-E0-49-C2-AE-D1-84-CD-11-6F-03-EE-8C-82-9F-28-75-C5-CF-14-D9-F8-45-9F-D4-72-9B-10-A9-55-EE-E0-B9-38-10-60-46-D2-F6-C0-CE-97-06-FA-E7-59-89-21-D6-9C-75-12-2B-C0-BD-01-E1-C2-2A-F7-A2-75-3C-F7-3E-A0-92-CA-0C-D5-E9-0C-24-E8-D9-44-02-27-EF-5F-9B-FD-60-A9-10-67-72-F1-48-82-C3-F1-9B-33-12-CD-37-3E-B6-C7-37-2B-11-52-AB-8F-A0-AF-13-7A-81-A2-19-D6-02-D9-0E-D9-A5-A2-76-DD-87-64-75-49-CB-24-87-49-3E-2D-08-71-63-33-53-D9-AC-94-F4-BC-DA-FF-AB-C6-2C-3C-82-0D-DF-04-0E-06-EE-B1-F0-75-B7-74-70-19-81-4B-27-B0-27-92-04-E4-19-E1-F3-33-B3-3F-4C-28-3B-82-B6-2F-69-40-2A-2A-24-6D-65-87-68-77-69-BB-0F";
            var publicKeyHex = "08-C6-02-B6-7C-6E-EF-A5-CC-6A-46-5C-54-FC-A5-37-98-2C-08-2F-0B-AF-D2-54-D1-34-8F-13-B3-C4-F2-F0-74-02-FA-EF-C4-00-54-7F-B1-21-76-A5-D0-73-D4-00-5E-D6-BC-E0-5A-A8-AF-8B-70-82-27-30-4F-E8-07-93-5C-5C-AC-3A-21-B8-71-3A-FD-A2-5A-02-DA-41-08-67-36-90-EB-9C-B5-83-D5-74-3C-B6-78-40-43-A4-00-16-D4-F7-F7-30-C0-BA-FB-B5-94-54-AD-75-9F-53-75-DB-54-C7-A9-BC-0D-9A-E1-5C-8D-38-64-64-2C-48-7D-95-35-A9-D2-F3-96-67-DA-2E-F3-FA-6D-47-50-E0-78-35-42-09-24-01-F9-42-70-FB-08-55-64-AE-EB-33-EF-4A-5B-78-24-3B-12-39-3F-0B-1A-30-7B-0C-C3-D7-E8-8F-24-E9-CA-42-4D-55-CE-41-E5-E7-F9-A5-71-06-6D-6E-4E-75-F0-E0-99-55-13-CC-87-91-48-86-54-68-E4-2D-54-01-64-A5-A6-79-EB-69-97-5A-18-39-DC-92-8D-1D-D3-15-C2-0C-51-C9-3D-73-0A-42-A6-AD-24-90-98-C2-8A-DC-82-00-5A-E5-08-BC-C9-13-19-45-7B-BB-B9-81-1C-81-21-EB-34-6D-1F-50-5C-38-B5-1D-4C-E9-3B-83-8D-07-13-15-C5-6B-A6-FB-E6-22-A2-28-28-B7-6E-1C-AE-95-E8-BA-A8-D0-68-8E-76-04-07-02-BF-76-9F-9B-05-1E-03-D3-0E-E5-85-11-85-84-2F-44-CF-F8-F1-12-97-82-39-C5-7D-03-F2-3A-EB-FA-7E-63-4A-BC-7D-A8-8F-48-D8-17-05-EF-7C-C1-90-E6-0B-37-E9-C6-94-B2-42-3E-BC-B1-00-31-81-D8-AF-7B-86-5D-75-16-A3-4D-9C-DF-29-5A-5E-41-CC-8F-8F-E2-6E-5F-DC-C5-E5-E7-29-6F-1B-05-8F-2F-C4-68-E3-4E-B0-26-E4-A7-DD-14-30-E8-F2-1E-CF-C0-FB-23-BC-FB-38-90-FF-04-D7-14-DD-2A-F5-97-90-22-E3-06-42-08-38-F4-C3-D4-A0-04-7A-E4-3C-CC-F9-90-25-4D-68-2C-3E-35-23-5F-7F-98-48-18-BD-89-DF-D7-33-77-8D-9F-30-88-60-87-E0-10-99-C5-04-D2-D9-93-9C-B8-AF-24-1B-08-0B-AD-98-AA-FC-25-F7-BB-40-05-A0-3C-8C-05-AF-A7-6D-37-CE-07-3E-BB-2A-C5-B0-ED-95-65-93-E3-90-8A-5A-76-4F-07-BA-5D-63-30-97-F8-45-25-59-16-CE-51-6E-6B-0E-B9-7A-80-A2-8A-AE-A5-51-7C-EB-D5-F7-E4-41-81-54-BB-B0-3D-3D-EA-F9-F7-82-F5-2B-35-1E-8D-88-7A-53-42-C9-9E-20-50-D5-B6-49-D1-87-46-07-6A-8D-5E-D3-F6-FA-1B-17-59-05-1A-6A-9E-F6-A4-EE-E8-FB-38-F6-7E-79-44-4E-45-95-E6-6E-DD-E9-F4-EF-15-67-28-9B-5E-13-1A-FC-51-84-B3-53-82-F2-7C-DC-24-07-E8-E1-8C-C6-C4-67-C8-7C-E0-73-F8-EF-53-C4-FA-B1-72-6B-9E-85-07-5F-11-03-0B-25-E2-E4-02-F5-CC-86-2A-C7-C5-0A-C1-FA-35-96-8F-55-5C-07-02-56-E1-38-2F-46-E1-5C-96-94-E9-20-BA-3C-3F-4D-47-F3-03-08-47-B0-79-E0-89-75-5F-D3-7E-F0-A6-B5-C9-6D-07-F9-2B-B3-49-24-0B-89-62-E5-07-CC-99-F2-A8-00-8B-9B-D3-0F-A1-09-D4-59-FB-7E-21-D0-FF-5A-A2-2C-A6-33-7B-DD-7A-ED-85-3C-17-07-8C-78-0B-77-3E-96-F1-1F-2D-66-6C-E8-0F-86-50-90-4A-95-0E-41-E3-90-77-16-2A-08-8C";
            var privKey = HexFunctions.ToBytes(privKeyHex);
            var peerKey = HexFunctions.ToBytes(peerKeyHex);
            var publicKey = HexFunctions.ToBytes(publicKeyHex);
            var secret = HexFunctions.ToBytes(secretHex);
            await CheckSecret(NamedGroup.ffdhe6144, privKey, peerKey, publicKey, secret);
        }

        //[Fact]
        public async Task Ffde8192KnownDerivedValue()
        {
            var privKeyHex = "11-82-D6-81-FB-65-9F-3F-E3-6C-A5-47-B3-E0-DB-7F-88-ED-95-C3-C5-E3-39-86-D1-7E-25-8E-C7-FB-C8-72-70-CA-C8-CD-11-49-A7-1C-18-C7-7C-8D-31-68-D8-4D-DE-89-80-B6-B0-EC-FE-9C-0D-C1-18-A7-CE-50-FD-63-D8-FA-9B-92-FA-C5-66-D5-53-08-E3-0B-E1-9E-50-C0-8C-FF-19-92-85-ED-F6-B5-C0-0B-0A-DC-02-40-1A-15-6A-F9-6D-A5-6B-CF-FD-DE-6E-FF-B5-85-8A-28-82-DC-17-07-D6-1E-B5-41-18-1A-58-B5-C5-E2-E8-A8-19-44-EC-16-76-CA-06-09-3C-F4-42-78-27-1A-8E-84-83-1A-B6-5F-1F-F1-75-6F-D5-61-A6-F8-F6-42-0C-2E-9B-ED-5F-F1-A1-26-CF-4B-18-91-A8-19-F1-E6-0E-9D-A0-AB-5C-71-74-9A-A7-75-66-1B-5D-AC-EB-76-33-1E-56-30-40-39-D9-3F-9A-5F-84-6B-76-17-70-58-32-47-A7-F2-C2-93-61-8E-0B-F3-B6-D7-A2-99-1D-1F-AC-B7-D1-79-17-53-01-1F-99-E0-CC-1C-FA-F8-41-99-20-9E-9A-B9-A4-E6-82-78-1C-66-DE-62-81-62-B2-BE-70-DE-F3-FF-52-41-E9-EE-41-14-AE-5C-36-63-FE-99-5A-8E-EF-5F-B9-7E-5B-28-4D-C5-4E-0E-32-45-FD-03-5E-19-A1-B3-3E-04-18-EE-08-98-17-18-AE-C5-37-B2-7D-C9-D7-80-5E-89-C0-E1-D0-72-26-42-6F-6A-F5-94-3D-7E-AA-A8-1A-8E-77-EF-1A-22-A5-34-45-BD-AA-ED-D7-73-12-53-B9-11-7A-52-27-5A-31-48-C8-EC-9F-43-B7-6F-00-F3-E8-7B-D7-68-3B-77-2C-00-19-08-6C-FC-0F-8A-24-33-58-80-9F-D2-26-A2-58-CA-91-D9-0C-B0-9D-99-9A-D7-F8-39-C3-70-2C-D4-F6-B9-0F-07-46-5C-16-77-A0-A1-BA-13-67-35-46-C4-89-51-45-73-63-D3-C3-EF-96-FE-EC-DF-A0-D3-EB-47-D8-70-9A-19-48-8A-1D-AA-8C-0F-9C-E1-D6-62-79-91-F7-0E-B3-4A-F4-0E-2E-CF-B5-0F-C3-A1-F0-00-24-67-38-37-07-39-0C-73-AD-17-D2-63-79-5D-27-31-FB-10-53-09-93-E5-61-CE-5B-B1-9D-71-86-11-2E-BC-72-33-CF-70-86-60-04-43-B1-0F-0D-B7-5C-89-81-03-70-68-37-7A-AC-C7-C6-6A-30-F4-1C-BD-E0-D4-BF-0B-7F-66-03-4E-42-AB-58-2C-F9-3F-C7-51-C8-17-EB-3F-90-5E-74-5E-83-4A-3D-99-C2-AC-61-92-E8-E2-0C-DC-DE-8E-CE-12-46-64-0E-14-69-A5-2A-3B-8B-81-15-5C-B5-4A-2A-28-C9-02-C9-54-39-0E-B0-B5-9E-C1-45-28-75-04-D1-F6-B0-05-A1-24-17-0E-2F-8B-00-61-A5-3E-35-44-9F-A0-84-AD-E8-D8-D3-31-EA-C6-F4-89-C1-FB-45-5D-D9-86-2A-FD-EE-A2-23-5D-1A-F4-CF-71-C8-97-37-E7-4E-AE-19-AF-03-59-69-46-A0-87-38-2E-AE-36-B4-54-2B-9B-B8-EE-16-D8-EA-E2-48-E8-FB-47-51-EB-20-5C-6C-7C-32-0F-AF-B5-FE-F5-62-50-A4-71-CB-C2-73-4F-69-8C-14-59-E1-25-CE-D3-EF-4E-83-2E-74-88-C1-5A-37-89-9C-09-60-E5-4E-66-A6-74-CA-3C-1E-4C-B3-60-C7-E7-33-1C-9F-CF-83-94-4E-2A-85-CB-FE-4A-65-F7-10-1E-A9-BB-1B-BD-B2-C1-29-34-4C-8D-69-6E-BE-07-90-5A-4E-09-74-4A-BC-06-9D-61-D3-BB-A2-EE-72-9F-7B-0C-2B-79-B0-23-71-4D-16-80-A2-6F-3E-62-51-80-C2-9D-4A-6A-27-CF-88-98-9C-1D-7B-A1-59-51-99-88-99-66-3A-C6-0D-10-FF-44-67-8B-A6-95-99-5B-12-BE-0A-E7-B0-63-81-0D-D3-59-39-AA-BF-65-4D-AA-3B-12-AC-1B-93-DB-0C-68-33-4C-D9-81-5B-2E-AC-AC-50-C1-49-8D-78-D2-C3-83-A6-FC-AF-B0-84-09-F8-0F-F3-4B-8B-DE-78-49-AA-90-F2-93-46-FB-28-12-78-17-C1-23-40-CD-19-B4-65-74-FA-F4-2D-67-5F-FC-26-92-38-52-02-75-EB-60-04-78-A1-62-4E-49-C8-81-07-E3-06-DD-92-6F-66-FB-F4-F6-AB-13-AE-F5-B0-9C-C7-0C-7F-D0-7B-C6-3E-F7-0C-6E-B0-7E-66-DF-5D-72-F9-DF-C9-22-08-7C-22-D8-B0-3B-A8-04-E4-6B-E7-19-39-8D-0A-B2-E8-B7-1E-AA-B9-1A-AE-CA-A5-F8-7C-52-90-F7-E8-EE-1B-75-63-AE-BB-4F-59-E5-DA-DA-22-92-16-CF-63-55-B1-96-7F-FD-5D-49-55-3D-B8-28-3C-65-79-48-77-67-E9-FA-03-77-EC-A2-05-4E-97-EC-CC-AA-70-F7-2D-31-61-E2-2A-2F-8B-D5-AE-C2-89-C4";
            var peerKeyHex = "CA-59-48-CA-EC-F1-95-00-99-1D-D0-A2-F4-1C-67-BE-9B-A6-FD-25-79-3B-61-9D-AB-87-48-6F-CF-34-C1-0B-AE-39-9C-18-44-95-68-24-87-B2-30-73-1D-E1-60-FE-81-5E-37-9A-1C-37-A0-B6-AB-29-CD-E5-CC-3D-D9-C1-6B-CE-62-40-41-F9-8C-EE-1C-73-15-CF-F7-B7-3F-FB-1B-F8-37-B4-44-4D-D2-63-D1-01-FD-B6-71-CF-AE-A5-07-38-5B-FB-6D-C3-1F-84-FB-DE-9A-63-C6-06-9E-5C-1C-F1-8B-48-93-73-C0-2C-3F-BD-04-3D-66-BC-80-E3-9E-39-6E-9A-81-E7-EC-B9-5F-6F-4B-CA-9F-7D-30-B5-55-87-B9-5F-66-E2-7E-68-45-1F-DC-B2-F4-6A-98-77-2F-92-7E-DF-85-B4-67-1A-9A-66-AB-C2-B8-C0-73-73-C2-4C-37-04-D4-87-DE-0F-AA-00-04-21-46-A4-AE-AF-1A-3B-44-D6-25-BB-54-9A-A4-EF-19-1C-45-E2-19-DC-D9-17-28-5E-A6-73-37-21-46-25-51-E1-5A-53-9F-53-8C-AB-1F-76-8E-32-F6-3B-DE-47-1C-04-45-71-FB-33-51-3B-B5-E5-81-B2-A5-79-43-41-E9-B5-3C-3D-CF-E3-A6-C9-FD-8C-F1-FF-BB-EE-0F-A4-35-9C-C9-A9-09-6F-88-E5-C0-00-96-5C-0F-96-6B-EF-7E-E9-01-09-71-1F-3C-7D-97-83-8C-22-F9-77-FF-7F-50-16-F7-0E-4B-5B-58-C0-D0-1B-EE-13-28-0A-9E-03-C5-9C-C8-E3-08-B4-49-2F-9C-F2-5F-27-E9-C5-7D-A0-C6-26-CF-E8-E7-7B-6A-9E-12-AE-58-B6-78-A5-DB-CA-65-FB-E2-C1-37-0A-50-EF-D6-D6-70-FD-9A-A4-72-4F-50-33-7E-67-09-C4-67-26-5A-17-A5-A2-08-5A-AC-46-0C-5F-11-DF-6A-7F-1F-87-BE-66-3E-32-E3-8E-3D-1F-5F-96-2C-39-3E-2C-7B-4B-D0-65-33-D2-22-5B-47-45-0A-2D-48-2B-74-97-23-7D-E9-85-B8-65-18-10-C7-D2-E5-CF-AD-6D-46-AD-56-2C-68-B2-26-76-1D-AA-EF-ED-83-1F-0B-FE-15-49-EF-A8-D0-05-45-1F-82-AF-F9-45-78-7A-37-18-28-38-B5-AA-20-85-9E-DF-30-F7-05-66-96-1A-68-B3-BD-C3-8C-02-D0-87-99-42-9B-D4-C5-AD-BB-FD-16-32-C5-53-F8-A2-3E-3A-88-8C-03-95-52-B4-B3-AF-71-59-F8-7F-58-DE-C0-AC-6F-0A-26-C1-D7-7E-B0-C1-CB-12-9A-4B-B6-E1-D6-B2-8F-91-8B-56-EC-5A-70-02-10-A9-E3-F9-84-74-91-02-E5-11-66-A2-02-F8-14-6D-47-A4-19-9C-30-BA-50-BA-78-C4-17-7F-DE-E1-EE-78-26-D8-45-C0-E2-4B-39-8B-16-9A-50-AA-FE-39-1D-71-8B-F0-44-FE-95-C0-C2-03-5A-93-1A-5E-03-F6-A6-39-30-C8-43-69-40-74-40-99-48-AE-29-00-DC-BD-9F-3A-74-CE-F7-F6-B0-F6-74-72-47-C5-17-6B-EE-DF-06-4E-2D-84-B7-13-98-93-61-14-7B-FD-AE-03-1E-4C-2D-97-50-48-D9-B7-FE-E4-A6-01-0C-36-28-C6-1E-02-66-F3-27-C9-40-58-85-E9-03-1D-18-57-9C-03-9D-B1-AF-0A-E5-C9-D6-FD-30-38-C3-DB-F1-72-2E-49-B1-69-E0-2D-1F-7E-E6-29-ED-BF-5C-74-F6-AB-DE-1C-47-78-80-87-E4-88-CF-4B-A8-1E-62-DA-34-62-B7-58-46-0A-64-94-17-67-CD-A1-A0-B2-86-D7-5A-94-73-88-82-B0-48-C3-F4-2A-17-C6-4A-6E-51-4B-77-33-A5-F2-B5-8A-76-4D-0A-28-93-74-61-5A-9C-53-AC-F4-CB-E5-B5-14-56-46-1B-A9-C1-15-07-E1-E7-2C-78-7B-3D-3F-C3-3D-2D-F4-56-11-2A-00-BB-99-03-03-00-D5-9F-F1-64-2B-2D-EE-47-5F-EB-5C-75-F2-A2-3F-1B-A4-CB-54-4D-49-B3-04-43-74-42-0E-7A-4E-DC-C3-74-0C-56-D2-F4-3F-F3-65-59-9F-3D-5D-FC-24-3C-67-9C-A1-F5-45-62-71-11-D8-4F-74-EF-66-7A-83-74-F4-9C-98-4E-EE-6F-AB-FA-69-31-BA-E2-9E-09-DE-68-95-77-C5-C7-96-29-5E-87-26-B2-5C-30-23-7E-45-EB-36-18-5D-86-87-46-70-E3-F1-1C-54-08-EC-0A-BF-7B-9B-E4-4A-05-87-ED-8F-D8-34-FD-C5-E4-DD-B0-DA-74-30-30-67-BC-D7-8A-F7-31-72-67-F1-02-67-A7-30-7F-B5-45-B7-76-8E-A9-A3-42-56-67-36-31-C1-D0-36-FB-23-3E-EC-FA-B9-52-68-AF-C5-19-DC-39-E7-88-87-9A-92-A3-09-B6-A2-54-C0-9A-0D-2D-BA-EF-57-3D-4C-92-69-A5-11-D4-00-10-27-E1-54-6F-26-5B-1F-87-0C-A0-AC-82-8B-13-B6-D7-E3-58-B2-9C-F4-B3-0B";
            var secretHex = "3F-36-F7-89-B3-8A-11-C1-D2-E4-E1-FD-BC-D9-B2-02-07-AB-6D-A1-D0-A0-A7-1E-D6-9C-82-06-07-27-50-D0-D1-17-CE-55-9A-C3-23-01-40-FB-88-56-FE-A4-69-A2-6D-67-22-57-0A-DF-AF-35-E2-B7-3D-07-DC-8B-5A-35-DE-1E-2A-0E-76-7B-FB-E9-CC-6B-EC-23-A8-72-84-7B-3A-E6-26-08-69-5B-D3-3F-B0-C1-F5-E2-4C-FC-68-32-85-CD-1A-84-9D-DD-64-6A-A1-49-02-84-AF-FC-61-2B-76-97-86-56-09-89-BF-4D-1A-1A-37-CA-DE-13-B7-50-68-09-1B-41-1D-AE-B7-B6-A1-80-91-FF-9C-CA-40-0D-AC-45-D5-68-12-94-99-A2-5E-D5-BB-14-5A-98-25-D1-A7-82-9C-F6-BD-2F-82-19-81-6C-3A-5A-8E-DE-27-E2-25-EB-1C-57-5A-1F-DC-51-3D-9B-9F-7B-B4-AE-F4-57-5E-08-13-A0-31-7F-12-A8-87-7E-A1-F3-3D-D4-4A-1E-00-EA-12-CF-B4-12-A5-22-1F-2D-45-34-A5-01-1F-96-50-AA-CC-37-18-6F-18-D6-0F-8B-3E-96-54-CE-C4-51-6C-71-60-E9-3D-A2-FE-70-D2-08-11-B5-D6-D7-AE-F8-0C-E2-42-7F-D1-95-51-BB-23-93-FB-C7-D1-D0-FC-94-3F-86-41-B2-EE-5D-92-89-4D-BE-DD-F2-D3-FE-CA-28-7A-AD-7F-D3-BF-57-C8-11-26-06-35-BA-08-18-06-32-81-E5-49-28-7F-DF-15-B5-92-39-D2-2B-13-C0-0E-15-A5-F5-7C-86-7A-A1-D7-1F-C7-51-E6-94-D2-E2-03-79-A2-89-9C-76-03-10-B3-E4-33-BA-F3-BC-5D-B1-3B-75-6F-47-8D-81-0F-DA-53-10-2E-CB-AE-39-32-98-EE-82-B4-9A-C2-7A-85-11-22-55-D1-B5-FA-59-08-6A-63-94-D0-58-20-66-C4-B5-17-3A-38-03-84-BD-2D-1D-B0-60-66-53-BC-69-74-91-F5-3D-69-97-98-6B-BD-0C-30-62-40-5B-7F-8E-A0-A6-FB-9E-7C-6F-98-F1-B9-E8-36-19-37-32-C7-F0-29-5F-FF-0A-68-5E-ED-C8-77-F8-80-31-B3-06-58-13-B9-D4-23-00-95-05-69-BD-84-BC-78-AD-4C-AB-5C-DA-16-4D-D2-78-56-60-52-F9-A7-F2-71-77-99-0B-3D-4C-C3-CF-EC-F1-DB-27-B5-FE-68-68-F5-C2-57-47-9A-21-A8-BF-AE-1D-B5-29-7F-6D-1C-64-E6-E8-61-7F-E0-F6-83-F6-4B-24-1F-48-30-58-2D-8A-99-F1-94-8E-71-E4-6A-54-71-B8-9D-24-7E-D1-F9-93-1F-DF-9F-AC-7B-A6-17-FD-24-68-07-09-05-41-E1-30-45-04-F9-3B-C4-B7-0E-8B-5D-09-D9-91-C9-E1-7C-78-DD-61-D4-72-E2-D5-7C-B7-78-D4-4D-0C-CC-C3-E7-06-1C-59-E0-5B-B4-E7-16-31-69-5B-E1-83-19-DB-06-8C-17-1E-EE-DB-C4-C8-94-34-CB-B7-7F-2C-5D-A0-14-16-68-C3-D9-F9-08-41-E1-BA-55-47-BC-0E-DB-5E-09-43-65-D1-83-BC-EC-EF-0D-2D-2B-C3-70-55-E0-1F-76-06-84-DD-2E-31-AA-6D-E0-3C-6C-60-A1-5F-DB-F9-96-E3-6C-7E-C4-0F-50-78-89-66-9D-62-A9-9C-52-88-D9-19-78-B5-E8-1C-E1-DE-87-AB-B5-DB-41-97-E9-1B-79-5B-7F-79-69-6D-94-BC-34-3B-A0-FF-84-6D-BE-45-7E-33-3A-B6-65-D5-71-8A-44-AF-FF-F2-7C-EC-A9-C0-85-7C-1B-F7-3B-11-BE-5F-9B-44-55-D4-ED-04-43-02-B4-B4-17-D7-27-34-18-61-C6-27-BB-6B-8B-40-96-1A-65-1E-AF-B7-D7-4E-11-C2-CB-E2-7C-A7-D8-E3-52-6C-A4-75-9C-ED-A6-C3-31-A3-30-76-24-A2-E5-A6-4D-37-32-BB-50-65-6E-8A-B2-DA-9C-F1-EE-95-06-9D-31-7F-6B-59-48-93-C8-5C-9C-11-8D-CB-DC-2A-ED-0D-93-B9-73-49-BB-E3-2C-B4-73-46-3D-7B-6A-F0-18-FF-94-76-A6-96-ED-13-EE-7F-2F-C9-2B-51-39-3F-D9-08-86-75-16-DD-49-54-CF-40-1B-6A-93-D1-36-98-AC-CF-60-24-3E-5D-8A-F9-BB-1B-B3-B1-97-6B-65-4F-C5-06-52-79-0B-7E-C8-CB-6C-2C-8B-A7-F2-98-EA-2A-95-9F-ED-48-BD-5F-5D-F6-11-20-22-C7-A3-72-53-6D-27-85-14-E6-C3-87-34-72-2A-42-66-B3-44-A9-51-FA-C2-B2-C2-14-9D-C0-39-4D-16-75-9C-50-D0-5C-A2-38-D8-C8-F9-35-AD-D7-A8-26-46-58-65-E2-B5-B4-60-FB-39-8E-CB-0C-D0-46-3E-34-F5-0B-B8-4B-DE-59-58-E8-05-A8-D8-5E-4A-AA-9E-A9-77-93-26-2F-8F-BF-74-34-57-FB-69-CE-DB-CE-F6-05-C7-41-34-58-1C-C1-47-5B-06-AE-26-29-B4-70-A9-9C";
            var publicKeyHex = "93-F2-68-85-32-52-F4-E7-EE-88-2A-07-F8-D0-5D-72-1E-A7-8D-A0-27-DC-4A-FD-29-27-CA-7A-24-DD-66-04-CB-F0-34-6D-90-5D-96-0C-1D-D0-DE-FA-A9-8A-EA-DB-0B-9D-50-E0-36-DD-68-D8-77-9D-99-D1-A7-B7-7A-BD-7C-4A-CB-47-02-27-51-02-D3-C2-F9-3C-62-4A-75-4A-17-F6-BC-77-20-EC-15-5C-EE-EA-67-0D-5C-3D-EE-1C-24-4E-E7-37-39-8B-19-B0-D1-FE-9C-BB-FD-B4-48-C2-4A-87-5E-30-DC-62-97-EE-4F-6D-4E-21-15-74-CC-19-2C-D7-E6-D7-5D-B8-59-2D-01-FF-7C-EC-C7-FD-3F-FE-0A-38-D9-40-2B-DE-C4-72-E3-40-FD-39-F2-63-8F-C6-8A-6B-09-12-9F-F7-8C-A8-2B-0E-53-88-DD-86-18-E6-DB-AB-E4-50-FE-71-AB-F3-0E-AB-98-7F-27-18-00-EB-CA-87-AC-41-D5-7F-F2-48-4C-9E-6E-4F-D0-75-65-E1-7C-1C-33-6E-9D-FF-D4-FE-49-06-08-54-F6-CC-E1-A5-86-DF-48-76-62-A1-47-0E-DC-B4-33-4A-75-3E-48-F3-5D-D1-3C-97-68-0A-AE-5A-9A-3D-0E-EF-69-E9-24-9B-A1-3B-5C-34-9F-0B-67-9E-4F-9B-A4-CF-EF-01-B8-3D-8E-27-8E-70-EF-51-FE-B5-6A-40-19-43-68-1A-7B-99-05-1D-5D-EA-23-69-C2-F2-D6-47-F8-82-2B-90-7D-4A-F3-67-C8-99-C7-07-AE-74-89-E5-2B-AE-20-96-CC-C8-41-2C-16-9C-43-66-B5-5A-D7-1A-01-42-B4-AD-5B-F3-FC-3B-F5-91-F1-54-C0-29-5C-09-65-02-48-65-7E-D7-9C-04-FF-1F-99-7F-CA-E1-3C-07-E9-71-F5-5C-17-29-B1-77-8E-8F-96-A8-96-1B-B6-63-59-12-54-CF-4A-CD-D5-88-74-F9-D8-C7-C6-6A-D0-51-F8-C1-E5-2B-A1-BF-D5-C1-55-28-B7-CE-F3-54-67-E5-2E-32-2C-63-33-8A-47-F1-8F-B2-ED-E3-83-C7-FD-3F-F2-FC-C0-67-56-C3-F2-9C-14-70-AB-41-46-8F-C0-35-C3-6A-ED-94-59-2B-5C-E7-1D-ED-DE-DA-2A-B3-C4-7D-81-41-05-03-B5-63-6B-1B-93-7B-F9-C1-1E-82-86-1B-5A-4D-8D-E5-71-F6-6D-3C-88-3E-04-6C-5C-DE-20-AE-ED-EC-B3-FD-38-04-45-51-D2-7F-59-18-28-8F-84-5F-0C-DC-48-16-6D-80-19-8F-82-23-5E-81-E6-C4-09-DE-CE-9B-FA-44-53-53-FC-6C-C7-F8-D8-3C-77-22-34-62-A4-E2-0B-E4-42-0E-0E-9F-7B-B0-15-16-69-4B-9E-23-0E-38-3F-0D-F6-AD-68-06-E7-14-74-3C-3E-DD-09-00-DC-7C-12-69-FC-88-A9-9F-23-2B-B2-64-4D-6D-85-2F-1B-C6-B0-39-95-16-7A-58-9F-7B-89-0D-F6-F9-B0-03-C3-0B-6B-96-13-63-BF-DB-7B-6C-8C-AB-29-30-A3-F6-7E-84-EB-BE-D2-C1-DD-FE-30-38-C7-C4-6A-BA-BC-02-2D-B8-A0-C5-1E-E7-68-5A-14-47-18-9B-01-5F-62-12-FA-39-23-A5-62-13-E3-02-25-32-37-E9-9B-DA-92-B0-11-C3-8C-16-A1-7C-1C-5E-E9-0B-55-44-0E-78-42-AB-9A-71-40-2D-4C-E5-3E-97-AD-80-B8-43-05-DD-82-4D-76-F8-21-E5-BF-0E-CA-17-BE-DB-48-E2-FD-08-86-05-84-4A-80-D4-B6-8E-4D-C6-83-A8-3C-38-3A-E1-45-B5-E9-2A-46-59-82-31-EA-76-B7-36-0F-E5-1D-D8-20-42-9F-0E-C9-B3-09-91-05-43-06-F0-61-69-65-19-FE-59-7E-15-33-A5-65-2C-A3-7B-17-27-B0-C4-72-61-07-1C-64-33-D5-93-06-13-05-0F-65-67-58-58-A1-3C-C4-45-1E-0D-8C-6F-E5-6C-8C-73-3C-DF-C8-5A-A3-C2-4D-17-16-BE-C7-CA-E4-F5-58-4F-B7-6C-DE-22-E1-A5-1B-CB-87-73-26-A4-9E-B7-54-03-79-E3-3A-F7-5F-0F-8E-95-B6-1C-53-29-7C-DE-AF-20-EE-9D-71-45-C5-6C-9E-72-AE-5E-B1-09-AC-D5-27-0A-C6-5A-25-30-5F-F3-96-43-CD-C3-B9-80-0D-67-27-DF-F6-80-8E-90-A4-E4-20-B3-75-7A-F3-5A-21-FC-66-9D-57-41-79-FC-18-13-D3-4E-20-A3-B2-DF-01-02-0B-11-36-CD-4C-3E-FA-3E-38-D4-C8-2F-0E-CD-35-A0-08-63-7D-33-57-E4-3B-F2-10-31-EB-03-D8-67-E5-D7-A0-A7-C3-97-09-D8-99-84-36-4D-F0-3D-99-5C-8F-00-76-4E-8B-2E-7B-EA-4C-A7-92-FA-DC-23-F6-EF-AE-DE-3E-F1-09-F9-85-72-A1-84-43-59-03-A2-29-82-2A-FC-F2-B3-EF-EA-3B-5B-9D-10-C5-7E-FC-F3-2B-39-0B-6C-1C-5A-74-DF-3A-47-77-64-F5-0E-B7-E8-88-11-88-72";
            var privKey = HexFunctions.ToBytes(privKeyHex);
            var peerKey = HexFunctions.ToBytes(peerKeyHex);
            var publicKey = HexFunctions.ToBytes(publicKeyHex);
            var secret = HexFunctions.ToBytes(secretHex);
            await CheckSecret(NamedGroup.ffdhe8192, privKey, peerKey, publicKey, secret);
        }

        //[Fact]
        public async Task Ffde2048KnownDerivedValue()
        {
            var privKeyHex = "05-1C-07-9D-81-F1-0A-27-0D-B0-E3-A0-5B-F7-F4-34-CB-B6-D0-8A-C1-C4-16-BB-D3-23-55-93-FA-00-4D-B7-66-2D-AE-5A-C3-54-9F-7C-36-4C-8C-6F-D8-EF-CB-2D-3D-6A-A3-BC-58-93-4D-B3-2A-DE-3F-76-B4-DF-6D-DF-7F-01-F2-BD-93-36-A7-39-9B-9C-09-59-28-6B-0D-C9-B9-2F-1D-CB-5C-0E-6E-ED-2A-DA-F3-86-A0-73-97-81-48-70-55-D1-40-D0-68-CC-D5-C7-6A-DE-91-CE-1E-08-5D-B9-0C-64-94-1C-CE-76-01-83-BC-E1-B0-60-E8-5F-CE-C3-77-79-73-B1-C0-7E-DB-54-31-52-AA-B6-F6-74-A5-9E-AD-65-E9-BB-82-F6-CF-A8-96-E7-D8-6F-47-D0-D2-32-9D-91-A4-C5-07-A2-A7-C6-76-5A-0D-EF-7A-0F-90-42-8D-CE-12-50-B3-9C-0B-5C-1F-C5-7A-62-31-A2-68-32-FF-2F-17-EC-55-E9-92-FB-41-C9-73-C7-9E-0D-74-D4-1C-C4-CD-D8-E5-7F-06-1E-46-78-89-CA-87-35-5E-13-75-48-24-B9-30-70-51-5E-F5-03-B9-B0-14-38-C2-B0-F5-D7-D2-3A-B3-F6-50-2F-C5-1D-CA-9D-F5-B4";
            var peerKeyHex = "4F-7A-80-DA-CB-EA-D6-AA-E2-70-1C-71-A6-37-E8-9E-48-E0-8F-2C-41-23-AA-0A-E4-45-26-0F-49-DB-25-54-F1-F6-4B-41-98-A4-E4-41-BE-23-AF-A4-62-CF-5A-99-DB-3D-93-35-5D-42-76-F1-EC-10-EB-EB-B9-C2-9A-29-A1-5B-6D-8A-A4-DE-EF-A3-6A-2C-6A-E0-BC-0E-AA-F6-D1-88-68-9C-A5-10-9E-42-F9-AB-C6-69-71-66-55-CC-61-03-79-F2-83-D1-DA-FE-AD-10-23-72-0E-DC-30-DE-E6-92-C8-9A-93-7B-FA-06-6C-E9-43-7B-A7-EA-B8-54-76-1C-74-08-81-8B-88-EB-C9-8A-04-6B-B2-92-30-83-DA-0B-F5-9E-BB-64-94-A6-F7-A6-32-C9-98-ED-B2-36-06-43-CD-1F-CA-F2-A5-6C-3E-BA-AB-40-8B-5E-52-13-EB-91-DE-73-68-48-C9-9B-A0-BE-B6-F5-B7-41-07-3B-5C-CF-1A-94-ED-02-0D-43-8C-16-F4-49-49-8C-99-C8-E5-CB-5B-B3-48-27-01-C3-68-46-7F-B9-EF-F4-66-3A-E9-32-11-DD-98-3F-2B-46-9D-BB-20-1F-D5-21-70-92-02-85-86-FD-59-E5-45-B6-56-64-64-7F-B4-28-82-A9";
            var secretHex = "76-62-7C-A2-A3-E8-0C-F9-DD-D6-D2-68-49-97-F1-F9-A5-70-D2-E7-0C-F4-8C-32-61-1D-C6-AC-48-8E-0F-E3-2E-1E-05-3B-22-3E-03-1A-93-1C-07-2C-0D-7C-B4-99-1E-93-CB-52-6D-C6-8D-65-09-31-2C-3E-6C-E5-1E-5F-A3-43-79-E8-DA-E1-64-CF-BC-E8-79-84-04-85-DF-AC-10-F0-CA-7F-17-22-51-A3-0C-2A-37-C4-5D-29-BD-A4-B9-2B-23-81-D4-47-CD-94-E4-C9-9F-41-2F-D5-AA-D3-54-93-72-40-71-A7-06-00-F6-24-02-BC-D6-25-FD-77-35-20-B6-EF-C9-A1-B0-06-E7-C6-5D-BB-7B-5F-85-3B-FB-32-4F-6A-34-BD-C8-03-1E-B1-D6-E9-F1-69-14-84-65-FB-FC-D2-47-9E-72-77-39-22-CE-CC-5D-ED-92-50-14-43-FB-0C-54-71-73-86-11-52-73-12-BD-9C-ED-D1-32-90-6F-71-80-A4-09-83-C1-87-4B-17-9C-D6-50-C5-A9-55-F6-9E-6D-E4-FA-5D-5D-40-5C-FB-56-3C-8A-19-D6-3E-14-32-0B-BC-77-ED-A1-C0-9D-EF-27-E7-2C-3C-FB-EB-8A-E4-B0-93-92-AF-2E-4F-A5-A8-B8-B0-E1-DD";
            var publicKeyHex = "A0-15-AD-42-4B-38-BE-5B-83-BF-DE-1A-78-0E-E9-11-D2-8C-AF-4C-96-0E-54-87-57-BE-53-F2-5D-99-FE-50-EF-83-E9-BC-69-85-E4-2F-69-A6-72-37-37-DE-52-61-C0-00-13-95-32-E2-FF-D0-26-2E-3D-D3-98-26-E1-61-53-18-05-54-75-53-6D-C2-73-71-84-D8-1B-9C-0B-10-D3-BD-62-5A-5A-6A-FF-D0-34-B1-32-21-98-62-D0-93-C6-F6-FA-06-8C-94-92-7E-FF-91-75-89-F4-BA-BA-4E-5E-63-43-7A-B2-9E-D7-76-78-3A-69-E7-2D-DA-79-00-9B-1B-AB-7A-BC-D6-36-89-5C-7C-D1-90-14-14-C0-35-5B-94-51-9B-E4-FD-A9-AB-6A-14-19-E2-B8-8A-4F-18-73-4A-29-5E-5D-50-76-D3-3C-A9-D8-8A-87-71-EE-5C-5A-BC-15-C9-40-79-77-99-41-82-EB-74-7F-E7-93-DE-1A-0C-72-62-CE-65-BB-53-FE-65-68-8D-69-26-FD-F9-62-3C-DE-42-0E-EE-3A-AC-23-AB-15-E5-5D-60-0F-42-DF-4B-77-C1-94-DC-2C-C4-BF-5D-4A-34-92-53-83-D9-86-FF-E1-4C-1F-C1-B0-02-75-C6-D0-57-CA-E4-24-DE";
            var privKey = HexFunctions.ToBytes(privKeyHex);
            var peerKey = HexFunctions.ToBytes(peerKeyHex);
            var publicKey = HexFunctions.ToBytes(publicKeyHex);
            var secret = HexFunctions.ToBytes(secretHex);
            await CheckSecret(NamedGroup.ffdhe2048, privKey, peerKey, publicKey, secret);
        }

        //[Fact]
        public async Task Ffde3072KnownDerivedValue()
        {
            var privKeyHex = "3A-62-55-A6-3F-0A-E9-51-10-FF-67-01-C2-08-15-F6-92-6C-29-39-8D-2A-1A-5E-CC-00-3A-A9-B3-0D-E6-57-9C-83-D5-50-E8-33-94-28-12-4A-20-56-2E-4E-A1-F5-98-66-98-E7-42-9C-E9-0A-12-F1-00-20-3F-97-AE-A0-9D-24-F4-F6-45-27-E9-BD-34-68-97-20-8E-96-DE-DF-4A-B5-8A-5E-B1-91-4D-CC-2D-49-66-54-DF-DE-9A-A4-BE-16-83-9C-D1-2E-BF-7C-2F-AB-72-99-1F-9C-47-DF-9D-F3-45-08-93-E4-C4-AC-86-98-59-40-4F-A8-4D-DE-BD-E5-A4-45-CD-96-0D-12-38-80-47-FC-81-27-7E-3A-E8-C5-49-79-10-8A-C0-A2-0E-0A-28-31-29-14-97-9C-A6-08-8B-4A-93-C0-D0-1B-F9-BF-D6-04-52-3B-18-91-D2-DF-84-E6-9A-71-38-14-9D-17-C3-C8-33-5A-79-7F-2E-CB-4F-E2-8A-F4-63-8E-D9-A5-A5-76-B4-65-B8-9E-6C-00-CB-67-66-A9-58-E2-FA-F2-38-14-27-55-91-46-32-36-D3-A8-CD-50-AA-D0-AB-45-9F-EE-21-90-95-02-A8-0B-F1-4E-46-5C-B3-D7-C6-AC-2D-A8-93-4E-8F-0F-C8-81-AA-18-63-BF-ED-36-99-1C-F5-55-19-12-AE-02-20-8D-7F-BC-E9-1D-24-60-BD-C2-DA-85-D3-FF-BC-C7-09-62-7A-23-D3-4E-E9-F6-63-3B-B9-A2-37-63-5E-57-96-E1-B9-66-14-BF-19-8F-E0-C4-22-2A-55-BE-84-DB-3A-0C-FB-42-58-9C-1B-97-A0-34-76-82-FB-B3-BB-BE-E4-5A-5C-8B-62-F1-38-D9-4C-F7-F6-D2-1B-9B-47-D1-20-98-68-73-24-41-41-CA-26-71-22-B1-7E-F2-C3-6A-43-2D-49-16-DC-04-D8-A8-8F-30-9B-0A-CE-29-1A-09";
            var peerKeyHex = "F5-0E-3E-AC-39-3D-65-20-A0-92-E8-87-11-42-EB-DD-AC-0B-64-69-23-8F-D8-16-60-4C-40-D4-35-88-D9-E4-C8-52-21-E3-5B-36-FF-96-80-8A-2A-F5-8A-18-57-AC-C6-B9-A3-4E-5B-1B-E7-F0-53-F5-23-C0-11-A9-0C-23-2E-53-52-B6-A8-0C-54-12-47-67-A9-FB-D4-F2-0C-41-10-E1-EA-14-78-CE-1A-04-F2-0F-04-D8-62-1F-AA-20-60-86-37-D0-27-D7-1C-40-3F-C2-EE-98-EF-7E-C1-35-5F-3D-1C-64-AC-08-9B-BC-2E-4C-B1-A3-A4-A0-6F-AF-4A-26-D6-31-BB-87-36-02-75-03-1E-30-C7-4E-25-57-42-1D-7D-22-75-CE-B9-2C-E0-0E-37-F3-CD-EA-32-CB-87-3A-69-4D-37-E3-12-23-18-01-C4-B3-98-1C-A3-87-E5-3F-E9-A4-AF-15-8F-CF-F2-A0-77-01-7A-8D-9D-B1-8B-81-D0-E2-E4-3E-7F-23-7F-DB-5A-6B-06-1B-1F-44-94-52-66-8E-2D-F9-B5-FF-8B-1F-72-80-EA-C4-33-77-95-E2-29-DB-61-16-87-8D-F5-01-A5-88-CE-0D-FC-1E-C5-CD-AA-7B-27-57-D2-61-9D-C1-7A-DB-3C-24-A6-FC-4C-00-A9-1D-46-12-38-EF-BD-DE-B0-9B-1C-06-5E-04-C4-92-83-92-DC-33-EA-2B-CA-A1-10-A3-29-7A-B0-6E-EC-D7-21-72-CE-36-5E-A5-FE-10-E3-05-87-72-16-41-40-12-B5-3E-AB-39-04-54-85-15-D8-F8-1D-B9-F8-4A-60-BE-83-02-DE-E5-51-B8-DF-C7-B9-42-D1-4F-CA-59-49-E7-C4-F7-C1-96-11-D3-EF-DF-FA-C7-E1-1A-D6-EA-BC-D4-51-70-81-60-1F-A1-45-7B-3C-B5-92-A7-8F-79-E1-67-BD-3C-15-09-33-97-96-5E-89-8F-DA-6E-88-72";
            var secretHex = "B0-60-3B-2A-4C-FA-3D-D3-60-26-6F-CD-62-2B-26-66-35-0D-4E-57-92-8D-71-E3-9D-47-F5-AD-78-98-32-49-E1-BF-68-1A-1A-79-35-61-E9-1D-EB-BE-5C-5D-D2-AE-A0-DA-C1-8B-33-6F-ED-DF-B5-14-7A-C4-E2-6D-29-9B-6D-33-55-93-A3-F0-49-77-F9-E1-57-62-81-F9-44-C0-FE-C3-71-94-4A-69-C7-74-9C-1F-CD-E9-B8-45-B0-31-CB-1F-81-B0-B4-52-D5-05-E9-E5-63-73-1F-07-2F-D9-7B-B1-0A-1C-A3-22-80-04-EE-FA-05-AC-B8-59-5A-4E-5D-01-90-E5-4B-FE-8A-C2-79-D7-98-94-53-C1-6A-F3-DF-B4-A0-C8-D8-7E-C2-30-FB-CB-75-F3-93-A9-A3-0E-43-6F-DE-67-E8-55-1B-B4-70-0E-47-44-18-76-93-87-9D-DD-F7-EA-B3-9F-C6-B9-98-36-B5-1E-FC-4A-A0-23-2F-CD-4A-5E-60-03-DE-14-4F-DA-C6-57-3B-2E-6A-3D-4C-70-E5-30-E1-B9-AB-04-21-FA-0E-A6-98-5F-D1-EF-B7-BA-E1-6B-21-C3-70-65-34-F8-09-85-46-72-81-87-5A-D7-DA-85-B4-48-18-80-3D-22-84-B2-30-63-82-2B-05-65-42-73-6B-95-32-06-B3-25-87-05-27-54-C3-70-5D-C4-46-F9-57-CB-3B-D1-FA-F0-EB-C0-C5-93-E0-6A-82-9D-2C-F2-FA-25-D5-9A-F1-B9-F6-87-32-E0-5A-F4-5C-85-3D-52-CC-E2-5D-8D-74-C0-B2-4C-EC-8B-A1-9D-49-BD-A3-53-43-44-D0-E3-7E-61-FD-1E-FA-07-56-70-A4-8E-18-E8-EB-1E-C7-50-7B-60-CD-3E-88-E8-FC-DD-1A-84-0D-E4-EF-46-49-6C-56-D7-BC-85-75-BD-D3-3F-AB-CC-FD-8A-12-18-1C-F0-12-0A-08-7E-FD-B3-2C-F9";
            var publicKeyHex = "D0-BA-50-B9-61-33-93-44-47-EF-AC-E5-17-2D-09-2F-05-FA-F6-88-95-7A-C0-A3-E7-FE-C8-E9-DC-EB-5C-00-B0-B0-C3-43-F8-6A-E9-BC-24-0D-F4-8A-9F-31-E9-8E-9E-EF-1D-F8-9A-D3-07-DA-8A-F8-E5-DF-56-F0-63-22-96-D3-77-C4-97-78-CB-6B-DE-A1-79-AE-12-DE-B3-D6-99-B7-F1-F9-AE-BE-44-8E-4A-D3-E0-66-28-23-28-9D-0E-B8-AB-45-B2-76-E3-BB-93-7F-E2-D3-67-A7-B1-BB-DD-B2-42-AD-5D-A7-67-A8-42-EF-99-FA-8C-1D-97-3B-B3-DA-3B-72-09-AD-C8-7D-DD-53-8F-9C-95-6C-86-F6-93-56-0F-9F-CE-F3-72-02-42-17-8E-24-02-B9-C0-08-C3-23-18-87-58-2F-94-BA-CD-EF-99-ED-3B-4F-DC-A6-AC-62-AD-55-22-62-A4-03-F8-24-20-BA-90-74-43-9A-41-D7-C1-CF-81-9A-EF-73-C9-98-A8-97-F6-07-CC-03-56-A4-3E-9A-03-64-01-D1-A4-F6-18-37-44-35-05-59-11-EB-22-B3-8B-47-F6-20-68-C8-6C-CD-55-13-8D-81-31-E1-E8-45-5C-D6-1C-A7-22-42-25-9E-1F-EF-19-9D-02-D7-0B-FC-5D-1E-69-25-46-00-3A-91-1A-E9-CB-0E-25-22-34-69-CA-21-59-13-A2-AE-52-54-5D-C0-A1-E2-1F-0F-28-68-E6-86-5A-E8-D4-AB-F2-34-07-DC-CE-F0-5C-9D-8E-41-45-AB-4B-3C-F6-95-FA-1D-EE-0E-C8-B0-05-23-C7-FD-E5-02-FD-C4-64-0F-15-BA-41-00-2B-C1-38-0F-73-08-B9-A8-BE-50-06-6A-3E-3E-99-1C-F8-92-7A-8C-DE-C6-36-60-F1-B9-71-48-BE-B1-19-3C-D5-29-6F-38-F1-CE-78-E0-82-A9-7D-33-0F-4C-7B-1E-D4-5F";
            var privKey = HexFunctions.ToBytes(privKeyHex);
            var peerKey = HexFunctions.ToBytes(peerKeyHex);
            var publicKey = HexFunctions.ToBytes(publicKeyHex);
            var secret = HexFunctions.ToBytes(secretHex);
            await CheckSecret(NamedGroup.ffdhe3072, privKey, peerKey, publicKey, secret);
        }

        private static async Task CheckSecret(NamedGroup group, byte[] privKey, byte[] peerKey, byte[] publicKey, byte[] secret)
        {
            using (var factory = new PipeFactory())
            {
                var pipe = factory.Create();
                var write = pipe.Writer.Alloc();
                write.WriteBigEndian((ushort)peerKey.Length);
                write.Write(peerKey);
                await write.FlushAsync();
                var reader = await pipe.Reader.ReadAsync();
                var instance = new OpenSsl11.OpenSslFiniteFieldKeyExchange(group);
                instance.GenerateKeys(privKey, publicKey);
                instance.SetPeerKey(new Internal.BigEndianAdvancingSpan(reader.Buffer.ToSpan()));
                var buffer = new byte[instance.KeyExchangeSize];
                var size = instance.DeriveSecret(buffer);
                var derived = buffer.Slice(0, size);
                Assert.Equal<byte>(secret, derived.ToArray());
            }
        }
    }
}
